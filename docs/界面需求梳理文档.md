# 英语分级阅读平台 - 界面需求梳理文档

> 基于 picture 目录中的界面截图进行需求分析和梳理
>
> 生成日期：2025-10-28

---

## 目录

- [一、用户端功能需求](#一用户端功能需求)
  - [1.1 认证系统](#11-认证系统)
  - [1.2 首页](#12-首页)
  - [1.3 阅读功能](#13-阅读功能)
  - [1.4 听力功能](#14-听力功能)
  - [1.5 单词本功能](#15-单词本功能)
- [二、管理端功能需求](#二管理端功能需求)
  - [2.1 管理后台总览](#21-管理后台总览)
  - [2.2 书籍管理](#22-书籍管理)
  - [2.3 词库管理](#23-词库管理)
- [三、前端需求汇总](#三前端需求汇总)
- [四、后端需求汇总](#四后端需求汇总)

---

## 一、用户端功能需求

### 1.1 认证系统

#### 1.1.1 登录页面 (登陆.png)

**界面元素：**
- 应用标题："AI Darrett English"
- 副标题：双语显示（中英文）
- 登录/注册 Tab 切换
- 邮箱输入框
- 密码输入框（带密码掩码）
- "忘记密码？" 链接
- "登录 Sign In" 主按钮
- 分隔线："OR CONTINUE WITH"
- "Continue with Google" 第三方登录按钮

**前端需求：**
- [ ] 实现登录/注册 Tab 切换
- [ ] 表单验证（邮箱格式、密码长度）
- [ ] 密码显示/隐藏切换
- [ ] Google OAuth 登录集成
- [ ] 登录状态管理（Token、用户信息）
- [ ] 错误提示处理

**后端需求：**
- [x] POST /api/auth/login - 邮箱密码登录
- [x] POST /api/auth/refresh-token - Token 刷新
- [ ] POST /api/auth/google - Google OAuth 登录
- [ ] POST /api/auth/forgot-password - 忘记密码
- [ ] POST /api/auth/reset-password - 重置密码

#### 1.1.2 注册页面 (注册界面.png)

**界面元素：**
- 邮箱输入框
- 密码输入框
- 确认密码输入框
- 密码强度指示器：
  - ❌ 至少 10 个字符
  - ✅ 包含字母
  - ✅ 包含数字
  - ✅ 密码匹配
- Cloudflare 验证
- "注册 Sign Up" 按钮
- Google 第三方注册

**前端需求：**
- [ ] 实时密码强度验证
- [ ] 密码匹配检查
- [ ] Cloudflare Turnstile 验证集成
- [ ] 注册成功后自动登录

**后端需求：**
- [x] POST /api/auth/register - 用户注册
- [ ] 密码强度校验（后端验证）
- [ ] 邮箱唯一性检查
- [ ] 验证码验证

---

### 1.2 首页

#### 1.2.1 首页布局 (首页.png)

**界面元素：**
- 顶部导航：首页、听力、阅读、单词本
- 右上角：登录按钮/用户头像
- 左侧标题："AI Creates, Kids Explore." / "AI创造，孩子探索"
- 两个主要内容区：
  - **Listening**（听力训练）
  - **Reading**（阅读文章）
- 卡片式内容展示，每张卡片包含：
  - 封面图片
  - 标题
  - 简介
  - 难度标签（easy/medium/hard 等）
  - 分类标签（如 Society & Culture, Space & Tech）

**前端需求：**
- [ ] 响应式卡片网格布局
- [ ] 内容懒加载/分页
- [ ] 卡片点击跳转
- [ ] 难度和分类标签显示
- [ ] 图片懒加载优化

**后端需求：**
- [ ] GET /api/content/featured - 获取首页推荐内容
- [ ] 支持按类型筛选（listening/reading）
- [ ] 支持分页

---

### 1.3 阅读功能

#### 1.3.1 阅读列表页 (阅读.png)

**界面元素：**
- 页面标题："Reading Articles"
- 副标题："Interactive content"
- 顶部分类筛选：
  - Sports
  - Space & Astronomy
  - Culture & Society
  - Natural Phenomena
  - Nonfiction
  - Science & Technology
- 难度筛选：Easy, Medium, Hard, Advanced, Expert
- 文章卡片网格展示

**前端需求：**
- [ ] 分类标签筛选（多选）
- [ ] 难度筛选（单选）
- [ ] 筛选结果实时更新
- [ ] 搜索功能
- [ ] 卡片排序（最新、热门、难度）

**后端需求：**
- [ ] GET /api/articles - 获取文章列表
- [ ] 查询参数：category, difficulty, page, limit, sort
- [ ] 分类数据管理
- [ ] 文章元数据返回

---

### 1.4 听力功能

#### 1.4.1 听力列表页 (听力.png, 听力分类.png)

**界面元素：**
- 页面标题："Listening Tracks"
- 顶部分类筛选：
  - All
  - Daily Life
  - Global Tech
  - History & Arts
  - Philosophy
  - Science & Nature
  - Society & Culture
- 难度筛选：All, Easy, Medium, Hard, Advanced, Expert
- 听力卡片展示

**前端需求：**
- [ ] 分类和难度双重筛选
- [ ] 筛选状态保持
- [ ] 卡片点击进入播放页

**后端需求：**
- [ ] GET /api/listening - 获取听力内容列表
- [ ] 查询参数：category, difficulty, page, limit
- [x] 分类数据返回

#### 1.4.2 听力播放页 - 完整模式 (听力交互.png)

**界面元素：**
- 左侧：文章封面图
- 右侧内容区：
  - 标题和分类标签
  - 难度标签
  - 控制栏：
    - Play Full Article 按钮
    - 速度调节：0.75x, 1x, 1.25x, 1.5x
    - 字体大小：Aa-M（可展开为 Aa-S, Aa-M, Aa-L, Aa-XL）
    - 显示中文开关
    - Focus Mode 按钮
  - 文章正文区域
- 右侧边栏："Word Definition"
  - "Click any word to see its definition here"
  - 点击单词后显示：
    - 单词发音按钮
    - lemma（词根）
    - pos（词性）
    - meaning（释义）
    - example（例句）
    - 原型、词性、词义（中文）
    - Save 按钮（需登录）

**前端需求：**
- [ ] 音频播放器组件（播放/暂停、进度条）
- [ ] 速度调节功能（0.75x - 1.5x）
- [ ] 字体大小切换（4档）
- [ ] 中文显示开关
- [ ] Focus Mode 切换
- [ ] 单词点击查询功能
- [ ] 单词定义侧边栏
- [ ] 单词保存到生词本（需登录提示）
- [ ] 未登录时显示登录提示

**后端需求：**
- [x] GET /api/listening/:id - 获取听力详情
- [ ] GET /api/listening/:id/audio - 获取音频文件
- [x] GET /api/vocabulary/query - 查询单词释义
- [x] POST /api/vocabulary - 保存单词到生词本
- [ ] 音频文件CDN存储

#### 1.4.3 听力播放页 - 逐句模式 (单词翻译的角度模式.png, 听力专注模式.png)

**界面元素：**
- 顶部：句子进度 "1 / 20"
- 中央大字号显示：当前播放的句子（英文+中文）
- 控制栏：
  - Hide Text (H) 开关 - 隐藏英文
  - 中文显示开关
  - Restart 按钮
  - Previous 按钮
  - Play 按钮（蓝色主按钮）
  - Next 按钮
  - 速度调节：0.75x, 1x, 1.25x, 1.5x
- 右侧单词定义面板（同完整模式）

**前端需求：**
- [ ] 逐句播放模式
- [ ] 句子进度显示（当前/总数）
- [ ] 句子导航（上一句/下一句）
- [ ] 隐藏英文文本功能
- [ ] 重新开始功能
- [ ] 当前句子高亮显示

**后端需求：**
- [ ] GET /api/listening/:id/sentences - 获取分句数据
- [ ] 句子分割存储
- [ ] 句子时间轴数据

#### 1.4.4 听力播放页 - 下划线标注模式 (开始听力训练（下划线）.png)

**界面元素：**
- 完整文章显示
- 当前播放句子：蓝色下划线标注
- 其他控制同完整模式

**前端需求：**
- [ ] 当前播放句子下划线高亮
- [ ] 自动滚动跟随播放进度
- [ ] 点击句子跳转播放

#### 1.4.5 字体和翻译设置 (听力训练翻译、速度、字体大小.png)

**界面元素：**
- 字体大小选择器展开：
  - Aa-S（小）
  - Aa-M（中）- 选中状态
  - Aa-L（大）
  - Aa-XL（超大）
- 中英文双语段落显示

**前端需求：**
- [ ] 字体大小切换并实时应用
- [ ] 设置状态本地缓存
- [ ] 双语段落样式

#### 1.4.6 专注模式可隐藏文本 (专注模式可隐藏逐句听.png)

**界面元素：**
- 极简界面
- 大字号句子显示
- 中文翻译（可选显示）
- Hide Text 开关启用时只显示中文

**前端需求：**
- [ ] 全屏/沉浸式界面
- [ ] 文本隐藏/显示切换
- [ ] 仅显示中文模式

---

### 1.5 单词本功能

#### 1.5.1 单词本页面 (单词本.png)

**界面元素：**
- 未登录状态：
  - 标题："Sign In Required"
  - 提示："Please sign in to access your wordbook."
  - "Sign In" 按钮

**前端需求：**
- [ ] 登录状态检查
- [ ] 未登录跳转登录页
- [ ] 单词列表显示（分页）
- [ ] 单词搜索/筛选
- [ ] 单词详情查看
- [ ] 单词删除功能
- [ ] 学习进度跟踪
- [ ] 复习提醒

**后端需求：**
- [x] GET /api/vocabulary - 获取用户生词本
- [x] POST /api/vocabulary - 添加单词
- [x] DELETE /api/vocabulary/:id - 删除单词
- [ ] PUT /api/vocabulary/:id/review - 标记复习
- [x] GET /api/vocabulary/stats - 统计数据

---

## 二、管理端功能需求

### 2.1 管理后台总览

#### 2.1.1 管理后台首页 (管理后台.png)

**界面元素：**
- 页面路径：localhost:3000/admin
- 顶部：返回按钮 + "管理后台" 标题
- 平台统计卡片：
  - 📚 总书籍数：4
  - 🔤 单词库：7,093
  - 📑 书签数：2
  - 📊 阅读会话：0
- Tab 切换：书籍管理、词库管理
- 上传新书籍区域：
  - 文件上传区（支持 PDF, DOCX, EPUB）
  - 书籍标题输入框
  - 作者输入框

**前端需求：**
- [ ] 管理后台路由保护（需管理员权限）
- [ ] 统计数据卡片展示
- [ ] Tab 切换功能
- [ ] 文件拖拽上传
- [ ] 文件类型验证
- [ ] 上传进度显示

**后端需求：**
- [ ] GET /api/admin/stats - 获取平台统计数据
- [ ] 管理员权限中间件
- [ ] 文件上传限制（大小、类型）

---

### 2.2 书籍管理

#### 2.2.1 书籍上传 (书籍管理.png, 书籍处理.png)

**界面元素：**
- 上传表单：
  - 选择文件（拖拽或点击）
  - 书籍标题（必填）
  - 作者（可选）
  - 书籍类型（下拉选择）
  - 难度标签（下拉选择）
  - 描述（可选）
  - "上传书籍" 按钮

**前端需求：**
- [ ] 文件上传组件
- [ ] 表单验证
- [ ] 上传进度条
- [ ] 上传成功/失败提示

**后端需求：**
- [ ] POST /api/admin/books/upload - 上传书籍文件
- [ ] 文件存储（本地/云存储）
- [ ] 文件格式解析（PDF/DOCX/EPUB）
- [ ] 书籍元数据提取
- [ ] 异步处理队列

#### 2.2.2 书籍列表管理 (书籍处理.png)

**界面元素：**
- 筛选器：全部、英文书籍、中文书籍
- 表格列：
  - 书名
  - 作者
  - 难度（原版/KET/PET等标签）
  - 单词数
  - 上传时间
  - 操作按钮
- 操作按钮（根据状态不同）：
  - 分章节（蓝色）
  - KET转写（橙色）
  - PET转写（紫色）
  - 删除（红色）
  - 预处理
  - 禁章转写
  - 自定义改写

**前端需求：**
- [ ] 数据表格组件（分页、排序）
- [ ] 语言筛选
- [ ] 批量操作
- [ ] 状态标签显示
- [ ] 操作确认对话框
- [ ] 处理进度实时更新

**后端需求：**
- [ ] GET /api/admin/books - 获取书籍列表
- [ ] 查询参数：language, status, page, limit
- [ ] DELETE /api/admin/books/:id - 删除书籍
- [ ] POST /api/admin/books/:id/split-chapters - 分章节
- [ ] POST /api/admin/books/:id/rewrite - 难度转写
  - 参数：target_level (KET/PET/custom)
- [ ] GET /api/admin/books/:id/processing-status - 处理状态查询

---

### 2.3 词库管理

#### 2.3.1 词库管理 (词典管理.png, 词库导入.png)

**界面元素：**
- **词库下载区域：**
  - 📋 词库模板 - 下载模板文件
  - 📄 完整词库 - 下载所有单词及释义
  - 🔤 待翻译单词 - 提取书籍中待翻译的单词
  - 各自有"下载"按钮
  - "同步词库" 按钮（蓝色）
  - "下载待翻译" 按钮

- **词库导入区域：**
  - 选择CSV文件上传区
  - 支持格式提示：单词、词性、中文释义、是否常用
  - "导入词库" 按钮（蓝色）
  - "下载模板" 按钮

- **使用说明：**
  - 文件格式要求：CSV文件，编码为UTF-8
  - 必需列：单词 (word)
  - 可选列：词性 (pos)、中文释义 (meaning)、是否常用 (is_common)
  - 支持中英文列名，系统会自动识别
  - 重复单词将被更新，新单词将被创建

**前端需求：**
- [ ] CSV文件上传组件
- [ ] 文件格式验证
- [ ] 上传进度显示
- [ ] 导入结果反馈（成功数、失败数、更新数）
- [ ] 模板下载功能
- [ ] 完整词库导出功能
- [ ] 待翻译单词提取功能

**后端需求：**
- [ ] POST /api/admin/vocabulary/import - 导入词库CSV
  - CSV解析和验证
  - 批量插入/更新单词
  - 返回导入统计信息
- [ ] GET /api/admin/vocabulary/template - 下载词库模板
- [ ] GET /api/admin/vocabulary/export - 导出完整词库
- [ ] GET /api/admin/vocabulary/untranslated - 导出待翻译单词
- [ ] POST /api/admin/vocabulary/sync - 同步书籍中的新单词

---

## 三、前端需求汇总

### 3.1 页面路由结构

```
/
├── / (首页)
├── /login (登录)
├── /register (注册)
├── /reading (阅读列表)
│   └── /reading/:id (阅读详情)
├── /listening (听力列表)
│   └── /listening/:id (听力播放)
├── /wordbook (单词本)
├── /profile (个人中心)
└── /admin (管理后台 - 需权限)
    ├── /admin/books (书籍管理)
    └── /admin/vocabulary (词库管理)
```

### 3.2 核心组件需求

#### 3.2.1 通用组件
- [ ] **导航栏组件** (NavBar)
  - 响应式导航
  - 登录状态显示
  - 用户菜单下拉

- [ ] **卡片组件** (ContentCard)
  - 封面图
  - 标题、简介
  - 难度标签
  - 分类标签
  - 点击交互

- [ ] **筛选器组件** (FilterBar)
  - 分类筛选
  - 难度筛选
  - 搜索框
  - 排序选择

#### 3.2.2 播放器组件
- [ ] **音频播放器** (AudioPlayer)
  - 播放/暂停
  - 进度条（可拖拽）
  - 当前时间/总时长
  - 速度调节
  - 音量控制

- [ ] **文章阅读器** (ArticleReader)
  - 字体大小调节
  - 中文显示开关
  - Focus Mode
  - 句子高亮
  - 滚动跟随

- [ ] **单词查询面板** (WordPanel)
  - 单词详情展示
  - 发音播放
  - 保存到生词本
  - 历史记录

#### 3.2.3 管理端组件
- [ ] **文件上传组件** (FileUploader)
  - 拖拽上传
  - 点击选择
  - 进度条
  - 文件预览

- [ ] **数据表格** (DataTable)
  - 分页
  - 排序
  - 筛选
  - 批量操作
  - 行操作按钮

### 3.3 状态管理需求

使用 Pinia Store:
- [ ] **userStore** - 用户状态（登录、个人信息、权限）
- [ ] **contentStore** - 内容数据缓存
- [ ] **playerStore** - 播放器状态（当前播放、进度、设置）
- [ ] **vocabularyStore** - 生词本数据
- [ ] **adminStore** - 管理后台状态

### 3.4 样式和主题

- [ ] 统一的设计系统（颜色、字体、间距）
- [ ] 响应式布局（移动端适配）
- [ ] 深色模式支持（可选）
- [ ] 动画和过渡效果
- [ ] Loading 状态样式

---

## 四、后端需求汇总

### 4.1 API 接口清单

#### 4.1.1 认证相关
- [x] `POST /api/auth/register` - 注册
- [x] `POST /api/auth/login` - 登录
- [ ] `POST /api/auth/google` - Google OAuth
- [x] `POST /api/auth/refresh-token` - 刷新Token
- [ ] `POST /api/auth/forgot-password` - 忘记密码
- [ ] `POST /api/auth/reset-password` - 重置密码
- [x] `POST /api/auth/logout` - 登出

#### 4.1.2 内容相关
- [ ] `GET /api/content/featured` - 首页推荐
- [ ] `GET /api/articles` - 文章列表
- [ ] `GET /api/articles/:id` - 文章详情
- [x] `GET /api/listening` - 听力列表
- [x] `GET /api/listening/:id` - 听力详情
- [ ] `GET /api/listening/:id/audio` - 音频文件
- [ ] `GET /api/listening/:id/sentences` - 分句数据

#### 4.1.3 单词相关
- [x] `GET /api/vocabulary` - 获取生词本
- [x] `POST /api/vocabulary` - 添加单词
- [x] `DELETE /api/vocabulary/:id` - 删除单词
- [x] `GET /api/vocabulary/query` - 查询单词释义
- [x] `GET /api/vocabulary/stats` - 统计数据
- [ ] `PUT /api/vocabulary/:id/review` - 标记复习

#### 4.1.4 用户相关
- [x] `GET /api/users/me` - 获取当前用户信息
- [ ] `PUT /api/users/me` - 更新用户信息
- [x] `GET /api/users/me/stats` - 用户学习统计
- [x] `POST /api/users/me/lexile` - 更新蓝斯值

#### 4.1.5 管理端 - 统计
- [ ] `GET /api/admin/stats` - 平台统计数据

#### 4.1.6 管理端 - 书籍管理
- [ ] `POST /api/admin/books/upload` - 上传书籍
- [ ] `GET /api/admin/books` - 书籍列表
- [ ] `GET /api/admin/books/:id` - 书籍详情
- [ ] `PUT /api/admin/books/:id` - 更新书籍
- [ ] `DELETE /api/admin/books/:id` - 删除书籍
- [ ] `POST /api/admin/books/:id/split-chapters` - 分章节
- [ ] `POST /api/admin/books/:id/rewrite` - 难度转写
- [ ] `GET /api/admin/books/:id/processing-status` - 处理状态

#### 4.1.7 管理端 - 词库管理
- [ ] `POST /api/admin/vocabulary/import` - 导入词库
- [ ] `GET /api/admin/vocabulary/template` - 下载模板
- [ ] `GET /api/admin/vocabulary/export` - 导出词库
- [ ] `GET /api/admin/vocabulary/untranslated` - 待翻译单词
- [ ] `POST /api/admin/vocabulary/sync` - 同步单词

### 4.2 数据模型补充

基于界面需求，需要补充以下数据模型字段：

#### 4.2.1 Book 表补充
```prisma
model Book {
  // 现有字段...

  // 需要补充：
  language        String?        // 语言（中文/英文）
  difficulty      String?        // 难度标签（original/KET/PET）
  processingStatus String @default("pending") // 处理状态
  wordCount       Int @default(0) // 单词数

  @@index([language])
  @@index([difficulty])
  @@index([processingStatus])
}
```

#### 4.2.2 ListeningContent 表补充
```prisma
model ListeningContent {
  // 现有字段...

  // 需要补充：
  sentences       Json?          // 分句数据（句子+时间轴）
  audioUrl        String?        // 音频文件URL
  coverImage      String?        // 封面图片

  @@index([difficulty])
}
```

#### 4.2.3 Vocabulary 表补充
```prisma
model Vocabulary {
  // 现有字段...

  // 需要补充：
  lemma           String?        // 词根
  pos             String?        // 词性
  example         String?        // 例句
  isCommon        Boolean @default(false) // 是否常用词
  pronunciation   String?        // 发音

  @@index([isCommon])
}
```

### 4.3 后台任务队列

需要实现的异步任务：
- [ ] 书籍文件解析任务
- [ ] 分章节处理任务
- [ ] 难度转写任务（KET/PET）
- [ ] 音频生成任务（TTS）
- [ ] 单词同步任务
- [ ] 批量导入任务

### 4.4 文件存储

- [ ] 书籍文件存储（PDF/DOCX/EPUB）
- [ ] 音频文件存储（MP3）
- [ ] 图片文件存储（封面图）
- [ ] CDN 配置
- [ ] 文件清理策略

### 4.5 权限系统

- [ ] 管理员角色定义
- [ ] 权限中间件
- [ ] 路由权限保护
- [ ] 操作审计日志

---

## 五、开发优先级建议

### P0 - 核心功能（必须完成）

1. **用户端基础功能**
   - [x] 登录/注册（邮箱密码）
   - [ ] 首页内容展示
   - [ ] 听力列表和播放
   - [ ] 单词查询和保存
   - [x] 生词本基础功能

2. **管理端基础功能**
   - [ ] 书籍上传
   - [ ] 书籍列表管理
   - [ ] 词库导入/导出

### P1 - 重要功能（应该完成）

1. **听力增强功能**
   - [ ] 逐句播放模式
   - [ ] 专注模式
   - [ ] 字体和速度设置
   - [ ] 进度保存

2. **书籍处理**
   - [ ] 自动分章节
   - [ ] 难度转写（KET/PET）

### P2 - 优化功能（可以推迟）

1. **用户体验优化**
   - [ ] Google OAuth 登录
   - [ ] 深色模式
   - [ ] 个性化推荐
   - [ ] 学习统计报表

2. **高级功能**
   - [ ] 音频自动生成（TTS）
   - [ ] AI 自动评估难度
   - [ ] 智能单词推荐

---

## 六、技术实现建议

### 6.1 前端技术栈

- **框架**: uni-app (Vue 3)
- **状态管理**: Pinia
- **UI 组件**: uni-ui + 自定义组件
- **HTTP 客户端**: 已有的 httpService
- **音频播放**: uni.createInnerAudioContext()
- **文件上传**: uni.uploadFile()

### 6.2 后端技术栈

- **框架**: NestJS
- **数据库**: PostgreSQL + Prisma
- **文件存储**: 本地存储 / Synology WebDAV / 阿里云OSS
- **队列**: Bull (Redis)
- **文件解析**:
  - PDF: pdf-parse / MinerU
  - DOCX: mammoth
  - EPUB: epub.js
- **音频处理**: FFmpeg / TTS服务

### 6.3 第三方服务

- **OAuth**: Google OAuth 2.0
- **TTS**: CosyVoice / Kokoro-FastAPI
- **AI服务**: DeepSeek API
- **CDN**: 阿里云 / Cloudflare

---

## 七、后续完善点

1. **性能优化**
   - [ ] 图片懒加载
   - [ ] 列表虚拟滚动
   - [ ] API 响应缓存
   - [ ] 静态资源 CDN

2. **用户体验**
   - [ ] 骨架屏
   - [ ] 错误边界
   - [ ] 离线缓存
   - [ ] 快捷键支持

3. **数据分析**
   - [ ] 用户行为追踪
   - [ ] 学习效果分析
   - [ ] 内容热度统计

4. **安全加固**
   - [ ] API 限流
   - [ ] 文件上传安全检查
   - [ ] XSS/CSRF 防护
   - [ ] SQL 注入防护

---

**文档版本**: v1.0
**最后更新**: 2025-10-28
**整理人**: Claude Code Assistant
